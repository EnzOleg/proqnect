{% extends 'base.html' %}
{% load static %}
{% block extra_css %}
    <link rel="stylesheet" href="{% static 'css/profile.css' %}">
    <script href="{% static 'js/like.js' %}"></script>
{% endblock %}
{% block title %}{{ user.first_name }} {{ user.last_name }}{% endblock %}

{% block main_content %}
<div class="profile-container">
    <!-- –û–±–ª–æ–∂–∫–∞ –∏ –∞–≤–∞—Ç–∞—Ä -->
    <div class="profile-header" style="background-image: url('{% if user.cover_photo %}{{ user.cover_photo.url }}{% else %}{% static 'images/default_cover.png' %}{% endif %}');">
        <div class="profile-info">
            <div class="avatar">
                <img src="{{ user.profile_picture.url }}" alt="–ê–≤–∞—Ç–∞—Ä–∫–∞" class="profile-avatar">
            </div>
            <div class="profile-name-status">
                <h1>{{ user.first_name }} {{ user.last_name }}</h1>
                <p class="status">{{ user.status|default_if_none:'' }}</p>
                {% if request.user == user %}
                    <a href="{% url 'settings' %}" class="btn-edit-profile">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å</a>
                {% else %}
                    <a href="{% url 'chat' user.id %}" class="btn-message">–ù–∞–ø–∏—Å–∞—Ç—å</a>
                    <form method="post" action="{% url 'add_friend' user.id %}">
                        {% csrf_token %}
                        <button type="submit" class="btn-add-friend">–î–æ–±–∞–≤–∏—Ç—å –≤ –¥—Ä—É–∑—å—è</button>
                    </form>
                {% endif %}
            </div>
        </div>
    </div>
    

    <!-- –ú–µ–Ω—é –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ –ø—Ä–æ—Ñ–∏–ª—è -->
    <div class="profile-menu">
        <a href="#">–ü—É–±–ª–∏–∫–∞—Ü–∏–∏</a>
        <a href="#">–î—Ä—É–∑—å—è</a>
        <a href="#">–§–æ—Ç–æ</a>
        <a href="#">–í–∏–¥–µ–æ</a>
    </div>

    <!-- –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç -->
    <div class="profile-content">
        <!-- –õ–µ–≤–∞—è –∫–æ–ª–æ–Ω–∫–∞ -->
        <div class="profile-sidebar">
            <h2>–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h2>
            <p>{{ user.bio|default_if_none:'–ù–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏' }}</p>
            <h2>–î—Ä—É–∑—å—è</h2>
            <ul>
                {% for friend in friends %}
                    <li>
                        <img src="{{ friend.profile_picture.url }}" alt="–ê–≤–∞—Ç–∞—Ä">
                        <p>{{ friend.first_name }} {{ friend.last_name }}</p>
                        <a href="{% url 'profile' friend.id %}">–ü–µ—Ä–µ–π—Ç–∏</a>
                    </li>
                {% empty %}
                    <p>–ù–µ—Ç –¥—Ä—É–∑–µ–π.</p>
                {% endfor %}
            </ul>
        </div>

        <!-- –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω–∞—è –∫–æ–ª–æ–Ω–∫–∞ (–õ–µ–Ω—Ç–∞) -->
        <div class="profile-feed">
            <div class="new-post">
                <form action="{% url 'add_post' %}" method="post" enctype="multipart/form-data">
                    {% csrf_token %}
                    <textarea name="content" placeholder="–ß—Ç–æ —É –≤–∞—Å –Ω–æ–≤–æ–≥–æ?" required></textarea>
                    <input type="file" name="image" accept="image/*">
                    <button type="submit">–û–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å</button>
                </form>
            </div>

            {% for post in posts %}
            <div class="post">
                <div class="post-header">
                    <img src="{{ post.user.profile_picture.url }}" alt="–ê–≤–∞—Ç–∞—Ä" class="post-avatar">
                    <div>
                        <p>{{ post.user.first_name }} {{ post.user.last_name }}</p>
                        <span class="post-date">{{ post.created_at|date:"d M Y H:i" }}</span>
                    </div>
                </div>
                <p>{{ post.content }}</p>
                {% if post.image %}
                    <img src="{{ post.image.url }}" class="post-image" alt="–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ">
                {% endif %}
                <div class="post-actions">
                    <form action="{% url 'feed:like_post' post.id %}" method="post">
                        {% csrf_token %}
                        <button type="submit">üëç {{ post.likes.count }}</button>
                    </form>
                    <a href="{% url 'feed:comment_post' post.id %}" class="btn-comment">üí¨ –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏</a>
                </div>
            </div>
            {% endfor %}
        </div>
    </div>
</div>
{% endblock %}